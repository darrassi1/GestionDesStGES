{% extends 'AdminUsersBundle::layout.html.twig' %}

{% block title %}   Dashboard Administration     {% endblock %}

{% block css %}
{% endblock %}
 {% block Menu %}
     <ul class="main-navigation-menu">
         <li class="active open">
             <a href="index.html">
                 <div class="item-content">
                     <div class="item-media">
                         <i class="ti-home"></i>
                     </div>
                     <div class="item-inner">
                         <span class="title"> Dashboard </span>
                     </div>
                 </div>
             </a>
         </li>
         <li>
             <a href="{{ path('admin_users_Profile') }}">
                 <div class="item-content">
                     <div class="item-media">
                         <i class="ti-settings"></i>
                     </div>
                     <div class="item-inner">
                         <span class="title"> Profile </span>
                     </div>
                 </div>
             </a>
         </li>
         <li>
             <a href="{{ path('admin_users_Messages') }}">
                 <div class="item-content">
                     <div class="item-media">
                         <i class="ti-settings"></i>
                     </div>
                     <div class="item-inner">
                         <span class="title"> Messages </span>
                     </div>
                 </div>
             </a>
         </li>
         <li>
             <a href="{{ path('admin_users_Agenda') }}">
                 <div class="item-content">
                     <div class="item-media">
                         <i class="ti-settings"></i>
                     </div>
                     <div class="item-inner">
                         <span class="title"> Agenda </span>
                     </div>
                 </div>
             </a>
         </li>
         <li>
             <a href="{{ path('admin_users_GestionStages') }}">
                 <div class="item-content">
                     <div class="item-media">
                         <i class="ti-settings"></i>
                     </div>
                     <div class="item-inner">
                         <span class="title">Gestion Stages </span>
                     </div>
                 </div>
             </a>
         </li>
         <li>
             <a href="{{ path('admin_users_Gestionsoutenances') }}">
                 <div class="item-content">
                     <div class="item-media">
                         <i class="ti-settings"></i>
                     </div>
                     <div class="item-inner">
                         <span class="title">Gestion soutenances </span>
                     </div>
                 </div>
             </a>
         </li>
         <li>
             <a href="{{ path('admin_users_GestionUsers') }}">
                 <div class="item-content">
                     <div class="item-media">
                         <i class="ti-settings"></i>
                     </div>
                     <div class="item-inner">
                         <span class="title"> Gestions Users </span>
                     </div>
                 </div>
             </a>
         </li>
         <li>
             <a href="{{ path('admin_users_GestionDocs') }}">
                 <div class="item-content">
                     <div class="item-media">
                         <i class="ti-settings"></i>
                     </div>
                     <div class="item-inner">
                         <span class="title"> Gestion Documents </span>
                     </div>
                 </div>
             </a>
         </li>
         <li>
             <a href="{{ path('admin_users_GestionRessources') }}">
                 <div class="item-content">
                     <div class="item-media">
                         <i class="ti-settings"></i>
                     </div>
                     <div class="item-inner">
                         <span class="title">Gestion Ressources </span>
                     </div>
                 </div>
             </a>
         </li>

     </ul>

 {% endblock %}
{% block pagetitle %}
     <section id="page-title" class="padding-top-15 padding-bottom-15">
         <div class="row">
             <div class="col-sm-7">
                 <h1 class="mainTitle">Dashboard</h1>
                 <span class="mainDescription">overview &amp; stats </span>
             </div>
         </div>
     </section>
{% endblock %}

{% block body %}
    <div class="container-fluid container-fullw bg-white">
        <div class="row">
            <div class="col-sm-4">
                <div class="panel panel-white no-radius text-center">
                    <div class="panel-body">
                        <span class="fa-stack fa-2x"> <i class="fa fa-square fa-stack-2x text-primary"></i> <i class="fa fa-smile-o fa-stack-1x fa-inverse"></i> </span>
                        <h2 class="StepTitle">Gerer les Utilisateurs</h2>
                        <p class="text-small">
                            To add users, you need to be signed in as the super user.
                        </p>
                        <p class="links cl-effect-1">
                            <a href="{{ path('admin_users_GestionUsers') }}">
                                view more
                            </a>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="panel panel-white no-radius text-center">
                    <div class="panel-body">
                        <span class="fa-stack fa-2x"> <i class="fa fa-square fa-stack-2x text-primary"></i> <i class="fa fa-paperclip fa-stack-1x fa-inverse"></i> </span>
                        <h2 class="StepTitle">Gerer les Documents</h2>
                        <p class="text-small">
                            The Manage Orders tool provides a view of all your orders.
                        </p>
                        <p class="cl-effect-1">
                            <a href="{{ path('admin_users_GestionDocs') }}">
                                view more
                            </a>
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="panel panel-white no-radius text-center">
                    <div class="panel-body">
                        <span class="fa-stack fa-2x"> <i class="fa fa-square fa-stack-2x text-primary"></i> <i class="fa fa-terminal fa-stack-1x fa-inverse"></i> </span>
                        <h2 class="StepTitle">Gerer les Ressources</h2>
                        <p class="text-small">
                            Store, modify, and extract information from your database.
                        </p>
                        <p class="links cl-effect-1">
                            <a href="">
                                view more
                            </a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="container-fluid container-fullw padding-bottom-10">
        <div class="row">
            <div class="col-sm-8">
                <div class="panel panel-white no-radius">
                    <div class="panel-body">
                        <div class="partition-light-grey padding-15 text-center margin-bottom-20">
                            <h4 class="no-margin">Soutenance Statistics</h4>
                            <span class="text-light">based on the major browsers</span>
                        </div>
                        <div id="accordion" class="panel-group accordion accordion-white no-margin">
                            <div class="panel no-radius">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a href="#collapseOne" data-parent="#accordion" data-toggle="collapse" class="accordion-toggle padding-15 collapsed" aria-expanded="false">
                                            <i class="icon-arrow"></i>
                                            This Month <span class="label label-danger pull-right">{{ ThisMonth|length }}</span>
                                        </a></h4>
                                </div>
                                <div class="panel-collapse collapse" id="collapseOne" aria-expanded="false" style="height: 0px;">
                                    <div class="panel-body no-padding partition-light-grey">
                                        <table class="table">
                                            <tbody>
                                            {% for article in ThisMonth %}
                                                <tr>
                                                    <td class="center">{{ article.Id_TypeSoutenance}}</td>
                                                    <td>{{ article.Salle_Soutenance}}</td>
                                                    <td class="center">{{ article.Date_Soutenance}}</td>
                                                    <td>{{ article.Id_Stage}}</td>
                                                </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div class="panel no-radius">
                                <div class="panel-heading">
                                    <h4 class="panel-title">
                                        <a href="#collapseTwo" data-parent="#accordion" data-toggle="collapse" class="accordion-toggle padding-15 collapsed" aria-expanded="false">
                                            <i class="icon-arrow"></i>
                                            Last Month <span class="label label-danger pull-right">{{ LastMonth|length }}</span>
                                        </a></h4>
                                </div>
                                <div class="panel-collapse collapse" id="collapseTwo" aria-expanded="false" style="">
                                    <div class="panel-body no-padding partition-light-grey">
                                        <table class="table">
                                            {% for article in LastMonth %}
                                            <tr>
                                                <td class="center">{{ article.Id_TypeSoutenance}}</td>
                                                <td>{{ article.Salle_Soutenance}}</td>
                                                <td class="center">{{ article.Date_Soutenance}}</td>
                                                <td>{{ article.Id_Stage}}</td>
                                            </tr>
                                            {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="panel panel-white no-radius">
                    <div class="panel-heading border-bottom">
                        <h4 class="panel-title">Users</h4>
                    </div>
                    <div class="panel-body">
                        <div class="text-center">
                            <span class="mini-pie"> <canvas id="chart3" class="full-width" width="100" height="150" style="width: 100px; height: 150px;"></canvas> <span>{{ admin|length +prof|length + stud|length  }}</span> </span>
                            <span class="inline text-large no-wrap">Acquisition</span>
                        </div>
                        <div class="margin-top-20 text-center legend-xs inline">
                            <div id="chart3Legend" class="chart-legend"><ul class="tc-chart-js-legend">
                                </ul></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container-fluid container-fullw bg-white">
        <div class="row">
            <div class="col-sm-12">
                <div class="row">
                        <div class="panel panel-white no-radius" id="visits">
                            <div class="panel-heading border-light">
                                <h4 class="panel-title"> Stage </h4>
                                <ul class="panel-heading-tabs border-light">
                                    <li class="panel-tools">
                                        <a data-original-title="Refresh" data-toggle="tooltip" data-placement="top" class="btn btn-transparent btn-sm panel-refresh" href="#"><i class="ti-reload"></i></a>
                                    </li>
                                </ul>
                            </div>
                            <div collapse="visits" class="panel-wrapper">
                                <div class="panel-body">
                                    <div class="height-350">
                                        <canvas id="chart1" class="full-width" width="644" height="350" style="width: 644px; height: 350px;"></canvas>
                                        <div class="margin-top-20">
                                            <div class="inline pull-left">
                                                <div id="chart1Legend" class="chart-legend"><ul class="tc-chart-js-legend">
                                                    </ul></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}


{% block javascript %}
    <script src="{{ asset('Backoffice/vendor/Chart.js/Chart.min.js') }}"></script>
    <script src="{{ asset('Backoffice/vendor/jquery.sparkline/jquery.sparkline.min.js') }}"></script>
    <script>
        var Index = function() {
            var chart1Handler = function() {
                var data = {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                    datasets: [{
                        label: 'stage not effect',
                        fillColor: 'rgba(220,220,220,0.2)',
                        strokeColor: 'rgba(220,220,220,1)',
                        pointColor: 'rgba(220,220,220,1)',
                        pointStrokeColor: '#fff',
                        pointHighlightFill: '#fff',
                        pointHighlightStroke: 'rgba(220,220,220,1)',
                        data: [{% for article in stage0 %}{% if article.month  == 1 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 2 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 3 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 4 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 5 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 6 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 7 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 8 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 9 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 10 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 11 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 12 %}{{ article.nbr  }}{% else %}0{% endif %}{% endfor %}]
                    }, {
                        label: 'stage effect',
                        fillColor: 'rgba(151,187,205,0.2)',
                        strokeColor: 'rgba(151,187,205,1)',
                        pointColor: 'rgba(151,187,205,1)',
                        pointStrokeColor: '#fff',
                        pointHighlightFill: '#fff',
                        pointHighlightStroke: 'rgba(151,187,205,1)',
                        data: [{% for article in stage1 %}{% if article.month  == 1 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 2 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 3 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 4 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 5 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 6 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 7 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 8 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 9 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 10 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 11 %}{{ article.nbr  }}{% else %}0{% endif %},{% if article.month  == 12 %}{{ article.nbr  }}{% else %}0{% endif %}{% endfor %}]
                    }]
                };

                var options = {

                    maintainAspectRatio: false,

                    // Sets the chart to be responsive
                    responsive: true,

                    ///Boolean - Whether grid lines are shown across the chart
                    scaleShowGridLines: true,

                    //String - Colour of the grid lines
                    scaleGridLineColor: 'rgba(0,0,0,.05)',

                    //Number - Width of the grid lines
                    scaleGridLineWidth: 1,

                    //Boolean - Whether the line is curved between points
                    bezierCurve: false,

                    //Number - Tension of the bezier curve between points
                    bezierCurveTension: 0.4,

                    //Boolean - Whether to show a dot for each point
                    pointDot: true,

                    //Number - Radius of each point dot in pixels
                    pointDotRadius: 4,

                    //Number - Pixel width of point dot stroke
                    pointDotStrokeWidth: 1,

                    //Number - amount extra to add to the radius to cater for hit detection outside the drawn point
                    pointHitDetectionRadius: 20,

                    //Boolean - Whether to show a stroke for datasets
                    datasetStroke: true,

                    //Number - Pixel width of dataset stroke
                    datasetStrokeWidth: 2,

                    //Boolean - Whether to fill the dataset with a colour
                    datasetFill: true,

                    // Function - on animation progress
                    onAnimationProgress: function() {
                    },

                    // Function - on animation complete
                    onAnimationComplete: function() {
                    },

                    //String - A legend template
                    legendTemplate: '<ul class="tc-chart-js-legend"><% for (var i=0; i<datasets.length; i++){\%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){\%><%=datasets[i].label%><%}%></li><%}%></ul>'
                };
                // Get context with jQuery - using jQuery's .get() method.
                var ctx = $("#chart1").get(0).getContext("2d");
                // This will get the first returned node in the jQuery collection.
                var chart1 = new Chart(ctx).Line(data, options);
                //generate the legend
                var legend = chart1.generateLegend();
                //and append it to your page somewhere
                $('#chart1Legend').append(legend);
            };
            var chart3Handler = function() {
                // Chart.js Data
                var data = [{
                    value: {{ admin|length }},
                    color: '#F7464A',
                    highlight: '#FF5A5E',
                    label: 'admin'
                }, {
                    value: {{ prof|length }},
                    color: '#46BFBD',
                    highlight: '#5AD3D1',
                    label: 'prof'
                }, {
                    value: {{ stud|length }},
                    color: '#FDB45C',
                    highlight: '#FFC870',
                    label: 'student'
                }];

                // Chart.js Options
                var options = {

                    // Sets the chart to be responsive
                    responsive: false,

                    //Boolean - Whether we should show a stroke on each segment
                    segmentShowStroke: true,

                    //String - The colour of each segment stroke
                    segmentStrokeColor: '#fff',

                    //Number - The width of each segment stroke
                    segmentStrokeWidth: 2,

                    //Number - The percentage of the chart that we cut out of the middle
                    percentageInnerCutout: 50, // This is 0 for Pie charts

                    //Number - Amount of animation steps
                    animationSteps: 100,

                    //String - Animation easing effect
                    animationEasing: 'easeOutBounce',

                    //Boolean - Whether we animate the rotation of the Doughnut
                    animateRotate: true,

                    //Boolean - Whether we animate scaling the Doughnut from the centre
                    animateScale: false,

                    //String - A legend template
                    legendTemplate: '<ul class="tc-chart-js-legend"><% for (var i=0; i<segments.length; i++){\%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){\%><%=segments[i].label%><%}%></li><%}%></ul>'

                };
                // Get context with jQuery - using jQuery's .get() method.
                var ctx = $("#chart3").get(0).getContext("2d");
                // This will get the first returned node in the jQuery collection.
                var chart3 = new Chart(ctx).Doughnut(data, options);
                //generate the legend
                var legend = chart3.generateLegend();
                //and append it to your page somewhere
                $('#chart3Legend').append(legend);
            };
            return {
                init: function() {
                    chart1Handler();
                    chart3Handler();
                    sparklineHandler();
                }
            };
        }();

    </script>
    <script>
        jQuery(document).ready(function() {
            Index.init();
        });
    </script>
{% endblock %}